# ============================================
# PostgreSQL Client Authentication Configuration File
# pg_hba.conf
# ============================================
#
# Формат:
# TYPE  DATABASE        USER            ADDRESS                 METHOD
#
# TYPE: local (Unix-socket), host (TCP/IP), hostssl (TCP/IP+SSL)
# DATABASE: имя базы или "all"
# USER: имя пользователя или "all"
# ADDRESS: CIDR адрес или hostname
# METHOD: trust, reject, scram-sha-256, md5, password, peer, ident
#
# ============================================

# ============================================
# РАЗРЕШЕННЫЕ ПОДКЛЮЧЕНИЯ (по заданию)
# ============================================

# 1. Unix-domain socket подключения (режим peer)
# Используется для локальных подключений через сокет
# Peer - аутентификация по имени пользователя ОС
local   all             all                                     peer

# 2. TCP/IP подключения ТОЛЬКО с localhost (scram-sha-256)
# IPv4 localhost
host    all             all             127.0.0.1/32            scram-sha-256

# IPv6 localhost
host    all             all             ::1/128                 scram-sha-256


# ============================================
# ЗАПРЕТ ВСЕХ ОСТАЛЬНЫХ ПОДКЛЮЧЕНИЙ
# ============================================
# Все строки ниже должны быть удалены или закомментированы
# для запрета других способов подключения

# НЕ ДОБАВЛЯЙТЕ никакие другие правила ниже!
# По заданию разрешены только:
# - Unix-domain сокет (peer)
# - TCP/IP с localhost (scram-sha-256)

# ============================================
# ПРИМЕРЫ (закомментированы)
# ============================================

# Разрешить с любого IP (НЕ ИСПОЛЬЗУЙТЕ без необходимости!)
# host    all             all             0.0.0.0/0               scram-sha-256
# host    all             all             ::/0                    scram-sha-256

# Разрешить с определенной подсети
# host    all             all             192.168.1.0/24          scram-sha-256

# Разрешить репликацию
# host    replication     all             127.0.0.1/32            scram-sha-256
# host    replication     all             ::1/128                 scram-sha-256

# Разрешить только определенную базу и пользователя
# local   bigbluecity     dbuser                                  peer
# host    bigbluecity     dbuser          127.0.0.1/32            scram-sha-256

# Запретить конкретного пользователя
# local   all             baduser                                 reject
# host    all             baduser         0.0.0.0/0               reject
